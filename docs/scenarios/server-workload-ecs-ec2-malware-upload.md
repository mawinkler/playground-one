# Scenario: Vision One XDR for Containers Detect Malware Upload

***DRAFT***

## Prerequisites

- Vision One XDR for Containers linked with Playground One VPC
- Playground One ECS Cluster with EC2 instances
  - Running app: Java-Goof running on vulnerable Tomcat
- Server & Workload Protection configuration set for
  - Tenant ID
  - Token
  - Policy ID of policy with Anti Malware protection enabled

Eventually set/update the Server & Workload Protection configuration

```sh
pgo --config
```

Ensure to have an ECS Cluster up and running:

```sh
pgo --apply ecs
```

## Disclaimer

> ***Note:*** It is highly recommended to have the `awsone.access_ip` set to a single IP or at least a small CIDR before deploying the ECS cluster. This will prevent anonymous users playing with your environmnent. Remember: we're using vulnerable apps.

## Exploiting

First, retrieve the load balancer DNS name

```sh
pgo -o ecs
```

Example output with ECS EC2:

```sh
cluster_name_ec2 = "playground-ecs-ec2"
loadbalancer_dns_ec2 = "playground-ecs-ec2-135067951.eu-central-1.elb.amazonaws.com"
```

### Exploit

To access the `todolist` application append `/todolist` to the loadbalancer DNS name in your browser.

Navigate to <http://playground-ecs-ec2-135067951.eu-central-1.elb.amazonaws.com/todolist>

Click `[Sign in]`

- Username: `foo@bar.org`
- Password: `foobar`

Then navigate to `Upload files` and upload some malware.

View events in Server & Workload Protection
